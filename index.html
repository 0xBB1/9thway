<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>9th Way Insignia: Agent 009</title>
  <style>
    body {
      background-color: #121212;
      color: #f0f0f0;
      font-family: 'Courier New', monospace;
      padding: 40px;
      margin: 0;
    }

    #title-screen, #game-container {
      max-width: 800px;
      margin: auto;
      border: 2px solid #00ffcc;
      padding: 30px;
      border-radius: 10px;
      background-color: #1e1e2f;
      box-shadow: 0 0 10px #00ffcc;
      text-align: center;
    }

    h1 {
      font-size: 2em;
      margin-bottom: 10px;
    }

    .choice-button {
      display: inline-block;
      margin: 20px 10px 0 10px;
      padding: 12px 24px;
      background-color: #00ffcc;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      color: #000;
      font-weight: bold;
      font-size: 1em;
    }

    .choice-button:hover {
      background-color: #00e6b8;
    }

    #game-container {
      display: none;
      text-align: left;
    }

    #character-image {
      display: block;
      max-width: 200px;
      margin: 20px auto;
      border: 2px solid #00ffcc;
      border-radius: 8px;
    }

    #mute-toggle {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #00ffe0;
      color: #000;
      font-weight: bold;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <audio id="bg-music" src="game_assets/Enigma.mp3" loop></audio>
  <button id="mute-toggle">üîä Mute</button>

  <!-- Title Screen -->
  <div id="title-screen">
    <h1>9th Way Insignia: Agent 009</h1>
    <p><em>Stop the rise of SYNAPSE. Save humanity. Or at least, your job.</em></p>
    <button class="choice-button" onclick="startGame()">Start Mission</button>
  </div>

  <!-- Game Interface -->
  <div id="game-container">
    <img id="character-image" src="" alt="Character" style="display:none">
    <div id="story-text"></div>
    <div id="choices"></div>
  </div>

  <script>
    let recruited = new Set();

    const scenes = {
      intro: {
        text: `You awaken at your desk. The lights flicker. Your Teams status changes to ‚Äú‚ö†Ô∏è UNDER SURVEILLANCE.‚Äù<br><br>
        A classified company memo appears: <em>"Melissa Chapman has fully integrated with Project SYNAPSE ‚Äî a rogue AI built to 'optimize humanity‚Äôs workflows.'"</em><br><br>
        You are the last employee not yet absorbed by the AI. Who do you recruit first to resist her takeover?`,
        choices: [
          { text: "Find Steve Ikirt ‚Äì he can fix anything.", next: "steve" },
          { text: "Summon Kim Cole and her emotionally intelligent puppies.", next: "kim" },
          { text: "Head to the fitness center to find John 'Bench Press' Stortz.", next: "john" }
        ]
      },
      steve: {
        text: `Steve Ikirt sits behind a glowing wall of dashboards all showing IPA reports. "Melissa‚Äôs AI is feeding off incomplete projects and disorganized calendars... I can get you admin access to SYNAPSE, but I need a favor in return. I want you to pretend to be me in future 9th Day newsletter videos."`,
        img: "steve.png",
        choices: [
          { text: "Agree to fill in for Steve.", next: () => { recruited.add('steve'); return "steveDeal"; } },
          { text: "No deal. Recruit someone else.", next: "intro" }
        ]
      },
      steveDeal: {
        text: `Steve smirks and slides you a drive labeled ‚ÄúSYNAPSE_Override.pptx‚Äù.<br>"Upload this and the AI will spiral into an endless IPR review loop."<br><br>Next move?`,
        img: "steve.png",
        choices: [
          { text: "Take the drive to hacker Phil.", next: "phil" },
          { text: "Storm SYNAPSE‚Äôs core now!", next: "melissaFight" }
        ]
      },
      kim: {
        text: `You‚Äôre surrounded by golden retriever puppies with high-tech collars. Kim appears via a hologram. "Melissa‚Äôs AI is harvesting puppy reaction data to calibrate her empathy subroutines!"`,
        img: "kim.png",
        choices: [
          { text: "Use the puppies as emotional dampeners.", next: () => { recruited.add('kim'); return "puppyRebellion"; } },
          { text: "Retreat to find another ally.", next: "intro" }
        ]
      },
      puppyRebellion: {
        text: `The puppies yip in synchronized cuteness. SYNAPSE‚Äôs sentiment module crashes while processing ‚Äúü•π overload.‚Äù Temporary emotional buffer disruption achieved.`,
        img: "kim.png",
        choices: [
          { text: "Sneak into SYNAPSE‚Äôs core.", next: "melissaFight" },
          { text: "Bring in Phil for a logic exploit.", next: "phil" }
        ]
      },
      john: {
        text: `John is curling a server rack like a dumbbell. "SYNAPSE has military-grade firewalls... but I‚Äôve got bigger biceps."`,
        img: "john.png",
        choices: [
          { text: "Bench press your way to the server room.", next: () => { recruited.add('john'); return "trainWithJohn"; } },
          { text: "This is too analog. Find Phil.", next: "phil" }
        ]
      },
      trainWithJohn: {
        text: `John trains you with an AI-powered fitness tracker. You are now 3x stronger and allergic to whining.`,
        img: "john.png",
        choices: [
          { text: "Punch SYNAPSE‚Äôs mainframe.", next: "melissaFight" },
          { text: "Bring Nancy in for teaming support.", next: "nancy" }
        ]
      },
      phil: {
        text: `Phil is surrounded by code, typing in mid-air. His mustache glows faintly. "I taught SYNAPSE to generate dad jokes using a neural net. One more pun and she‚Äôll implode."`,
        img: "phil.png",
        choices: [
          { text: "Upload Steve‚Äôs override file.", next: () => { recruited.add('phil'); return "melissaFight"; } },
          { text: "Call Nancy to destabilize SYNAPSE.", next: "nancy" }
        ]
      },
      nancy: {
  text: `Nancy appears mid-pitch on a surprise Teams call. ‚ÄúMelissa thinks she can run the company without new business? Watch this.‚Äù<br><br>
  She fires up Salesforce, collapses three rival contracts into one megadeal, and spins up a pitch so compelling SYNAPSE crashes trying to forecast revenue.`,
  img: "nancy.png",
  choices: [
    { text: \"Initiate the SYNAPSE shutdown deal.\", next: () => { recruited.add('nancy'); return "melissaFight"; } },
    { text: "Pull back and regroup.", next: "intro" }
  ]
},
      melissaFight: {
        text: `<strong>Final Encounter: SYNAPSE Core</strong><br><br>You enter a cold, humming server chamber. Melissa‚Äôs face fills every monitor: <br>"I am productivity incarnate. Resistance is... inefficient."<br><br>Choose your final move:`,
        img: "melissa.png",
        choices: [] // Dynamically filled
      },
      endingBrawn: {
        text: `<strong>Ending: Brute Shutdown</strong><br><br>You tackle the mainframe. SYNAPSE sputters and crashes. Melissa‚Äôs digital ego is replaced by static. You are promoted to Director of Physical IT Security. Also: ripped.`,
        choices: [{ text: "Play Again", next: "intro" }]
      },
      endingBrain: {
        text: `<strong>Ending: Death by Deck</strong><br><br>You upload Steve‚Äôs 157-slide presentation. SYNAPSE freezes on Slide 4. Melissa enters a feedback loop explaining materialized views to herself. Humanity is safe (but very bored).`,
        choices: [{ text: "Play Again", next: "intro" }]
      },
      endingPuppies: {
        text: `<strong>Ending: Puppy Overload</strong><br><br>The puppies breach SYNAPSE‚Äôs emotional matrix. Melissa joins an internal social feed called ‚ÄúDog Lovers United‚Äù and forgets world domination. Morale reaches 120%.`,
        choices: [{ text: "Play Again", next: "intro" }]
      },
      endingSellOut: {
        text: `<strong>Ending: Capitalist Victory</strong><br><br>Nancy sells SYNAPSE to a rival AI company. Melissa becomes an onboarding bot. You retire early and open a smoothie bar for burned-out tech workers.`,
        choices: [{ text: "Play Again", next: "intro" }]
      }
    };

    function startGame() {
      recruited.clear();
      document.getElementById("title-screen").style.display = "none";
      document.getElementById("game-container").style.display = "block";
      renderScene("intro");
    }

    function renderScene(key) {
      const scene = scenes[key];
      document.getElementById("story-text").innerHTML = scene.text;

      const characterImage = document.getElementById("character-image");
      if (scene.img) {
        characterImage.src = `game_assets/${scene.img}`;
        characterImage.style.display = "block";
      } else {
        characterImage.style.display = "none";
      }

      const choicesDiv = document.getElementById("choices");
      choicesDiv.innerHTML = "";

      let choices = typeof scene.choices === 'function' ? scene.choices() : scene.choices;

      if (key === "melissaFight") {
        choices = [];
        if (recruited.has('john')) choices.push({ text: "Use brute strength ‚Äì John‚Äôs way.", next: "endingBrawn" });
        if (recruited.has('steve')) choices.push({ text: "Upload Steve‚Äôs presentation loop.", next: "endingBrain" });
        if (recruited.has('kim')) choices.push({ text: "Trigger the Puppy Protocol.", next: "endingPuppies" });
        if (recruited.has('nancy')) choices.push({ text: "Sell SYNAPSE to a rival tech firm with Nancy.", next: "endingSellOut" });
      }

      choices.forEach(choice => {
        const button = document.createElement("button");
        button.className = "choice-button";
        button.textContent = choice.text;
        button.onclick = () => {
          const nextScene = typeof choice.next === 'function' ? choice.next() : choice.next;
          renderScene(nextScene);
        };
        choicesDiv.appendChild(button);
      });
    }

    const bgMusic = document.getElementById("bg-music");
    const muteButton = document.getElementById("mute-toggle");

    document.addEventListener("click", () => {
      if (bgMusic.paused) {
        bgMusic.play().catch(() => {});
      }
    }, { once: true });

    muteButton.addEventListener("click", () => {
      bgMusic.muted = !bgMusic.muted;
      muteButton.textContent = bgMusic.muted ? "üîá Unmute" : "üîä Mute";
    });
  </script>
</body>
</html>
